# OAMMap

Небольшая утилита для создания наглядной карты памяти PPU OAM.

![oammap_demo](/oammap_demo.png)

Карта представляется в виде набора квадратов, каждый квадрат соответствует одному физическому расположению ячейки памяти на чипе.

Ячейки помечаются цветами:
- LimeGreen: Byte 0 (Y)
- Ivory: Byte 1 (Index)
- Red: Byte 2 (Attr)
- Blue: Byte 3 (X)
- DarkViolet: Bytes for Temp OAM (общим цветом)

Внутри каждой ячейки находится подпись, вида `AA-B`:
- AA: Адрес ячейки 00-FF
- B: Номер бита соответствующего байта.

Учитывайте что в OAM физически отсуствуют ячейки для разрядов 2-4 байта атрибутов (Byte 2). Однако в Temp OAM для них есть место, но туда всегда копируются нули.

## NTSC vs PPU

Одной из отличительных особенностей в NTSC версии PPU является то, что адрес OAM подается в инвертированном виде (`/OAM0-7`). Это приводит к тому, что логические номера колонок перестают соответствовать их физическому расположению.

Разработчики PPU также учли эту особенность для подключения рядов для разрядов 2-4:

![pal_oam_row_outputs2](/pal_oam_row_outputs2.png)

(NTSC PPU слева)

## Как смотреть карту

Утилита создает .xml файл, который нужно открывать в утилите Deroute (File -> Add entities...)

https://github.com/emu-russia/psxdev/releases

## Заранее сделанные карты OAM

:warning: Картинки большие и могут повредить ваш мозг.

|NTSC OAM Map|PAL OAM Map|
|---|---|
|![oammap_ntsc](/oammap_ntsc.png)|![oammap_pal](/oammap_pal.png)|
